import type { NextPage } from 'next';
import Head from 'next/head';
import Image from 'next/image';
import styles from '../styles/Home.module.css';

import React, { useState, useEffect } from "react";
import { Fab, Paper, Table, TableBody, TableCell, TableContainer, TableRow } from "@mui/material";
import { initializeApp, getApp, getApps } from "firebase/app";
import { getFirestore, collection, getDocs} from "firebase/firestore";
import {firebaseConfig} from '../settings/firebaseConfig';

const firebaseApp = getApps().length === 0 ? initializeApp(firebaseConfig) : getApp();
const db = getFirestore();

const TextList = () => {

  // const [open, setOpen] = useState(false);
  const [text, setText] = useState<any[]>([]);
  useEffect(()=>{
    async function readData() {
      const querySnapshot = await getDocs(collection(db, "text"));
      const temp:any[] = [];
      
      querySnapshot.forEach((doc) => {
        console.log(doc.id, doc.data());
        temp.push({content:doc.data().content});
      });

      console.log(temp);

      setText([...temp]);

    }

    readData();

  },[]);


  // const renderTask = (task: Task, index: number) => {
  //   return (
  //     <TaskListItem
  //       key={task.name}
  //       index={index}
  //       name={task.name}
  //       location={task.location}
  //     />
  //   );
  // };

  //////////////////////////////////////////////////

  const renderText = (text: any, i: number) => {
    return (
      // <div className={styles.grid}>
      <TableRow>
        <TableCell align="left">{i+1}</TableCell>
        <TableCell align="left">{text.content}</TableCell>
        <TableCell align="right">
      </TableCell>
    </TableRow>    
    // </div>
    );
    
  };


  return (
    <div className={styles.container}>
      
      <TableContainer component={Paper}>
        <Table sx={{ minWidth: 350 }} aria-label="simple table">
          <TableBody>{text.map(renderText)}</TableBody>
        </Table>
      </TableContainer>

    </div>
  );
};

//export default TextList;



const Home: NextPage = () => {
  const [text, setText] = useState<any[]>([]);
  useEffect(()=>{
    async function readData() {
      const querySnapshot = await getDocs(collection(db, "text"));
      const temp:any[] = [];
      
      querySnapshot.forEach((doc) => {
        console.log(doc.id, doc.data());
        temp.push({content:doc.data().content, title:doc.data().title});
      });

      console.log(temp);

      setText([...temp]);

    }

    readData();

  },[]);
  const renderText = (text: any, i: number) => {
    return (
      <div className={styles.card} key={text.title}>
      <h2>{text.title}</h2>
      <p>{text.content}</p>
      <div className={styles.card2}>
        {/* <Image className={'user-pic user-info-pic-posi'} src={myImg} width="160" height="160" alt="" /> */}
        <p>victoria</p>
        <span className="heart" id="heart"></span>
        <span className="five-star" id="five-star"></span>
      </div>
      
    </div>
    );
    
  };

  return (
    <div className={styles.container}>
      <Head>
      <title>筆記分享區</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        <h1 className={styles.title}>
          Education Zone
        </h1>

        <div className={styles.grid}>
        {text.map(renderText)}
        </div>

      </main>
    </div>
  )
}

export default Home
